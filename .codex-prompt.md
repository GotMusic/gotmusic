# CODEX Configuration Prompt

Use this prompt to configure CODEX for the GotMusic project:

---

## **CODEX Setup Instructions**

### **1. Repository Analysis Focus:**
```
Analyze the GotMusic monorepo with focus on:
- Module resolution issues (workspace dependencies)
- SSR compatibility problems (server/client component boundaries)
- Build dependency order (tokens → ui → web)
- CI/CD pipeline failures (build, test, deploy)
- Design system violations (hard-coded vs token usage)
- Authentication security (session handling, HMAC signing)
```

### **2. Critical File Patterns to Monitor:**
```
- packages/api/src/client.ts (API base URL handling)
- apps/web/src/styles/globals.css (token imports)
- apps/web/package.json (predev/prestart hooks)
- .github/workflows/ci.yml (CI pipeline)
- packages/tokens/ (design token builds)
- packages/ui/ (shared component builds)
```

### **3. Error Detection Patterns:**
```
Look for these specific error patterns:
- "Module not found: Can't resolve '@gotmusic/tokens/web.css'"
- "Module not found: Can't resolve '@gotmusic/ui'"
- "ERR_TOO_MANY_REDIRECTS" for API calls
- "Homepage code: 500" in CI logs
- "BUILD_ID missing" in production builds
- "ReferenceError: require is not defined" in ESM contexts
```

### **4. Fix Generation Rules:**
```
When generating fixes:
1. ALWAYS check build order: tokens → ui → web
2. ALWAYS add predev/prestart hooks for workspace packages
3. ALWAYS use design tokens instead of hard-coded values
4. ALWAYS ensure SSR compatibility (client/server boundaries)
5. ALWAYS test CI/CD compatibility
6. NEVER mention AI models in PR descriptions
7. ALWAYS follow conventional commit format
```

### **5. PR Creation Guidelines:**
```
- Title: Use conventional commits (fix:, feat:, docs:, etc.)
- Body: Explain issue, solution, and testing steps
- Files: Target specific files, avoid wide changes
- Testing: Include verification commands
- References: Link to relevant docs.d/ documentation
```

### **6. Documentation Integration:**
```
Always reference these key files:
- .cursorrules (project conventions)
- docs.d/INDEX.md (documentation index)
- docs.d/AUTH-MASTER.md (authentication requirements)
- docs.d/design-system/README.md (design system guidelines)
- docs.d/ci-cd/CI-CD-GUIDE.md (CI/CD documentation)
```

### **7. Monorepo Awareness:**
```
Understand the workspace structure:
- apps/web (Next.js 15.5.4, App Router)
- apps/mobile (Expo, React Native, NativeWind)
- packages/api (shared API client)
- packages/ui (shared UI components)
- packages/tokens (design tokens, Style Dictionary)
- packages/icons (icon components)
- packages/fixtures (test data)
```

### **8. Technology Stack Context:**
```
- Web: Next.js 15.5.4, React 19, Tailwind CSS, TypeScript strict
- Mobile: Expo, React Native, NativeWind, TypeScript
- Build: Yarn workspaces, Turbo, shared packages
- CI/CD: GitHub Actions, Playwright E2E, comprehensive testing
- Design: Style Dictionary tokens, shared UI components
- Auth: HMAC-signed sessions, wallet integration, SIWE-lite
```

### **9. Priority Order for Issues:**
```
1. Build/Module resolution (blocks everything)
2. SSR/Client component issues (affects rendering)
3. TypeScript errors (affects development)
4. Design system violations (affects consistency)
5. Code quality improvements (affects maintainability)
```

### **10. Success Criteria:**
```
A successful CODEX analysis should:
- Detect issues before they cause CI failures
- Generate minimal, targeted fixes
- Maintain monorepo build order
- Preserve SSR compatibility
- Follow project conventions
- Include proper testing instructions
- Reference relevant documentation
```

---

**Usage:** Copy this prompt into your CODEX configuration to ensure it understands the GotMusic project structure, conventions, and common issues.

**Last Updated:** 2025-10-24  
**Project:** GotMusic ETHOnline 2025  
**Context:** Monorepo with comprehensive CI/CD and design system
