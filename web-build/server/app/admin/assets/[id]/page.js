(()=>{var a={};a.id=448,a.ids=[448],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9681:(a,b,c)=>{Promise.resolve().then(c.bind(c,22603)),Promise.resolve().then(c.bind(c,29338)),Promise.resolve().then(c.bind(c,40098))},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16529:(a,b,c)=>{"use strict";c.d(b,{default:()=>g});var d=c(78157),e=c(89981),f=c(31768);function g({assetId:a,status:b}){let[c,g]=(0,f.useState)(null),[h,i]=(0,f.useState)(!1),[j,k]=(0,f.useState)(null),l=(0,e.I0)({onSuccess:a=>{k(null)},onError:a=>{k(a.message)}});async function m(){i(!0),k(null),g(null);try{let b=await fetch(`/api/assets/${a}/download`);if(!b.ok)throw Error(`HTTP ${b.status}`);let c=await b.json();if(!c.url)throw Error(c.message||"No URL returned (stubbed)");g(c.url)}catch(a){k(a instanceof Error?a.message:"error")}finally{i(!1)}}async function n(){c&&await navigator.clipboard.writeText(c)}return(0,d.jsxs)("div",{className:"mt-2 space-y-2 text-sm",children:["processing"===b&&(0,d.jsxs)("div",{className:"space-y-2 rounded-md border border-warning/20 bg-warning/10 p-3",children:[(0,d.jsx)("div",{className:"text-warning font-medium",children:"Asset is processing"}),(0,d.jsx)("p",{className:"text-fg/70 text-xs",children:"Simulate processing completion (in production, this would be automatic):"}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("button",{type:"button",className:"rounded-md bg-success px-3 py-1.5 text-xs font-medium text-white disabled:opacity-50",onClick:function(){k(null),l.mutate({assetId:a,status:"ready"})},disabled:l.isPending,children:l.isPending?"Marking...":"Mark as Ready"}),(0,d.jsx)("button",{type:"button",className:"rounded-md bg-danger px-3 py-1.5 text-xs font-medium text-white disabled:opacity-50",onClick:function(){k(null),l.mutate({assetId:a,status:"error",errorMessage:"Manual error trigger"})},disabled:l.isPending,children:"Mark as Error"})]})]}),(0,d.jsx)("button",{type:"button",className:"inline-flex items-center rounded-md bg-[var(--color-brand-600)] px-3 py-2 text-xs font-medium text-white disabled:opacity-50",onClick:m,disabled:h||"processing"===b,children:h?"Generating…":"Generate download link"}),c?(0,d.jsxs)("div",{className:"rounded bg-white/5 p-2",children:[(0,d.jsx)("div",{className:"truncate",children:c}),(0,d.jsx)("button",{type:"button",className:"mt-1 underline",onClick:n,children:"Copy"})]}):null,j?(0,d.jsx)("div",{className:"text-red-400",children:j}):null,(0,d.jsx)("p",{className:"text-fg/70",children:"Note: route is stubbed; will return a short-lived signed URL later."})]})}},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},22603:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(25459).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/runner/work/gotmusic/gotmusic/apps/web/src/app/admin/assets/[id]/AssetActions.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/runner/work/gotmusic/gotmusic/apps/web/src/app/admin/assets/[id]/AssetActions.tsx","default")},24111:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>m,dynamic:()=>n});var e=c(5939),f=c(84139),g=c(81796),h=c(22134),i=c(22603),j=c(29338),k=c(40098),l=a([f]);f=(l.then?(await l)():l)[0];let n="force-dynamic";async function m({params:a}){let{id:b}=await a,c=await f.db.select().from(f.w.assets).where((0,g.eq)(f.w.assets.id,b)).then(a=>a[0]);return c?(0,e.jsxs)("main",{id:"main-content",className:"p-6",children:[(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsxs)("h1",{className:"text-2xl font-semibold","data-testid":"asset-detail-heading",children:["Asset #",c.id]}),(0,e.jsx)("p",{className:"text-fg/70","data-testid":"asset-detail-subtitle",children:"Manage asset details and settings"})]}),(0,e.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,e.jsx)("div",{className:"lg:col-span-2",children:(0,e.jsx)("div",{className:"rounded-md border border-fg/10 bg-bg p-6","data-testid":"asset-edit-form",children:(0,e.jsx)(j.default,{assetId:c.id})})}),(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"rounded-md border border-fg/10 bg-bg p-4","data-testid":"asset-actions",children:[(0,e.jsx)("h2",{className:"text-sm font-semibold",children:"Actions"}),(0,e.jsx)(i.default,{assetId:c.id,status:c.status})]}),(0,e.jsxs)("div",{className:"rounded-md border border-fg/10 bg-bg p-4",children:[(0,e.jsx)("h2",{className:"text-sm font-semibold",children:"Asset Info"}),(0,e.jsxs)("dl",{className:"mt-3 space-y-2 text-sm",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("dt",{className:"text-fg/70",children:"Created"}),(0,e.jsx)("dd",{children:new Date(c.createdAt).toLocaleDateString()})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("dt",{className:"text-fg/70",children:"Last Updated"}),(0,e.jsx)("dd",{children:new Date(c.updatedAt).toLocaleDateString()})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("dt",{className:"text-fg/70",children:"ID"}),(0,e.jsx)("dd",{className:"font-mono text-xs",children:c.id})]})]})]}),(0,e.jsx)(k.default,{assetId:c.id})]})]})]}):(0,h.notFound)()}d()}catch(a){d(a)}})},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},28354:a=>{"use strict";a.exports=require("util")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29338:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(25459).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/runner/work/gotmusic/gotmusic/apps/web/src/app/admin/assets/[id]/AssetEditForm.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/runner/work/gotmusic/gotmusic/apps/web/src/app/admin/assets/[id]/AssetEditForm.tsx","default")},29720:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(73653),e=c(97714),f=c(85250),g=c(37587),h=c(22369),i=c(1889),j=c(96232),k=c(22841),l=c(46537),m=c(46027),n=c(78559),o=c(75928),p=c(19374),q=c(65971),r=c(261),s=c(79898),t=c(32967),u=c(26713),v=c(40139),w=c(14248),x=c(59580),y=c(57749),z=c(53123),A=c(89745),B=c(86439),C=c(58671),D=c.n(C),E=c(18283),F=c(39818),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["admin",{children:["assets",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,24111)),"/home/runner/work/gotmusic/gotmusic/apps/web/src/app/admin/assets/[id]/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,84686)),"/home/runner/work/gotmusic/gotmusic/apps/web/src/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,58671,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,17983,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,15034,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,54693,23)),"next/dist/client/components/builtin/unauthorized.js"]}]}.children,I=["/home/runner/work/gotmusic/gotmusic/apps/web/src/app/admin/assets/[id]/page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/admin/assets/[id]/page",pathname:"/admin/assets/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/admin/assets/[id]/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},33873:a=>{"use strict";a.exports=require("path")},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},45345:(a,b,c)=>{"use strict";c.d(b,{default:()=>ae});var d=c(78157),e=c(89981),f=c(71159),g=c(31768),h=a=>a instanceof Date,i=a=>null==a,j=a=>!i(a)&&!Array.isArray(a)&&"object"==typeof a&&!h(a),k="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function l(a){let b,c=Array.isArray(a),d="undefined"!=typeof FileList&&a instanceof FileList;if(a instanceof Date)b=new Date(a);else if(!(!(k&&(a instanceof Blob||d))&&(c||j(a))))return a;else if(b=c?[]:Object.create(Object.getPrototypeOf(a)),c||(a=>{let b=a.constructor&&a.constructor.prototype;return j(b)&&b.hasOwnProperty("isPrototypeOf")})(a))for(let c in a)a.hasOwnProperty(c)&&(b[c]=l(a[c]));else b=a;return b}var m=a=>/^\w*$/.test(a),n=a=>void 0===a,o=a=>Array.isArray(a)?a.filter(Boolean):[],p=a=>o(a.replace(/["|']|\]/g,"").split(/\.|\[/)),q=(a,b,c)=>{if(!b||!j(a))return c;let d=(m(b)?[b]:p(b)).reduce((a,b)=>i(a)?a:a[b],a);return n(d)||d===a?n(a[b])?c:a[b]:d},r=(a,b,c)=>{let d=-1,e=m(b)?[b]:p(b),f=e.length,g=f-1;for(;++d<f;){let b=e[d],f=c;if(d!==g){let c=a[b];f=j(c)||Array.isArray(c)?c:isNaN(+e[d+1])?{}:[]}if("__proto__"===b||"constructor"===b||"prototype"===b)return;a[b]=f,a=a[b]}};let s={BLUR:"blur",FOCUS_OUT:"focusout"},t={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},u={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};g.createContext(null).displayName="HookFormContext";let v="undefined"!=typeof window?g.useLayoutEffect:g.useEffect;var w=a=>"string"==typeof a,x=a=>i(a)||"object"!=typeof a;function y(a,b,c=new WeakSet){if(x(a)||x(b))return a===b;if(h(a)&&h(b))return a.getTime()===b.getTime();let d=Object.keys(a),e=Object.keys(b);if(d.length!==e.length)return!1;if(c.has(a)||c.has(b))return!0;for(let f of(c.add(a),c.add(b),d)){let d=a[f];if(!e.includes(f))return!1;if("ref"!==f){let a=b[f];if(h(d)&&h(a)||j(d)&&j(a)||Array.isArray(d)&&Array.isArray(a)?!y(d,a,c):d!==a)return!1}}return!0}var z=(a,b,c,d,e)=>b?{...c[a],types:{...c[a]&&c[a].types?c[a].types:{},[d]:e||!0}}:{},A=a=>Array.isArray(a)?a:[a],B=()=>{let a=[];return{get observers(){return a},next:b=>{for(let c of a)c.next&&c.next(b)},subscribe:b=>(a.push(b),{unsubscribe:()=>{a=a.filter(a=>a!==b)}}),unsubscribe:()=>{a=[]}}},C=a=>j(a)&&!Object.keys(a).length,D=a=>"function"==typeof a,E=a=>{if(!k)return!1;let b=a?a.ownerDocument:0;return a instanceof(b&&b.defaultView?b.defaultView.HTMLElement:HTMLElement)},F=a=>E(a)&&a.isConnected;function G(a,b){let c=Array.isArray(b)?b:m(b)?[b]:p(b),d=1===c.length?a:function(a,b){let c=b.slice(0,-1).length,d=0;for(;d<c;)a=n(a)?d++:a[b[d++]];return a}(a,c),e=c.length-1,f=c[e];return d&&delete d[f],0!==e&&(j(d)&&C(d)||Array.isArray(d)&&function(a){for(let b in a)if(a.hasOwnProperty(b)&&!n(a[b]))return!1;return!0}(d))&&G(a,c.slice(0,-1)),a}function H(a){return Array.isArray(a)||j(a)&&!(a=>{for(let b in a)if(D(a[b]))return!0;return!1})(a)}function I(a,b={}){for(let c in a)H(a[c])?(b[c]=Array.isArray(a[c])?[]:{},I(a[c],b[c])):n(a[c])||(b[c]=!0);return b}function J(a,b,c){for(let d in c||(c=I(b)),a)H(a[d])?n(b)||x(c[d])?c[d]=I(a[d],Array.isArray(a[d])?[]:{}):J(a[d],i(b)?{}:b[d],c[d]):c[d]=!y(a[d],b[d]);return c}let K={value:!1,isValid:!1},L={value:!0,isValid:!0};var M=a=>{if(Array.isArray(a)){if(a.length>1){let b=a.filter(a=>a&&a.checked&&!a.disabled).map(a=>a.value);return{value:b,isValid:!!b.length}}return a[0].checked&&!a[0].disabled?a[0].attributes&&!n(a[0].attributes.value)?n(a[0].value)||""===a[0].value?L:{value:a[0].value,isValid:!0}:L:K}return K},N=(a,{valueAsNumber:b,valueAsDate:c,setValueAs:d})=>n(a)?a:b?""===a?NaN:a?+a:a:c&&w(a)?new Date(a):d?d(a):a;let O={isValid:!1,value:null};var P=a=>Array.isArray(a)?a.reduce((a,b)=>b&&b.checked&&!b.disabled?{isValid:!0,value:b.value}:a,O):O;function Q(a){let b=a.ref;return"file"===b.type?b.files:"radio"===b.type?P(a.refs).value:"select-multiple"===b.type?[...b.selectedOptions].map(({value:a})=>a):"checkbox"===b.type?M(a.refs).value:N(n(b.value)?a.ref.value:b.value,a)}var R=a=>n(a)?a:a instanceof RegExp?a.source:j(a)?a.value instanceof RegExp?a.value.source:a.value:a,S=a=>({isOnSubmit:!a||a===t.onSubmit,isOnBlur:a===t.onBlur,isOnChange:a===t.onChange,isOnAll:a===t.all,isOnTouch:a===t.onTouched});let T="AsyncFunction";var U=a=>!!a&&!!a.validate&&!!(D(a.validate)&&a.validate.constructor.name===T||j(a.validate)&&Object.values(a.validate).find(a=>a.constructor.name===T)),V=(a,b,c)=>!c&&(b.watchAll||b.watch.has(a)||[...b.watch].some(b=>a.startsWith(b)&&/^\.\w+/.test(a.slice(b.length))));let W=(a,b,c,d)=>{for(let e of c||Object.keys(a)){let c=q(a,e);if(c){let{_f:a,...f}=c;if(a){if(a.refs&&a.refs[0]&&b(a.refs[0],e)&&!d)return!0;else if(a.ref&&b(a.ref,a.name)&&!d)return!0;else if(W(f,b))break}else if(j(f)&&W(f,b))break}}};function X(a,b,c){let d=q(a,c);if(d||m(c))return{error:d,name:c};let e=c.split(".");for(;e.length;){let d=e.join("."),f=q(b,d),g=q(a,d);if(f&&!Array.isArray(f)&&c!==d)break;if(g&&g.type)return{name:d,error:g};if(g&&g.root&&g.root.type)return{name:`${d}.root`,error:g.root};e.pop()}return{name:c}}var Y=(a,b,c)=>{let d=A(q(a,c));return r(d,"root",b[c]),r(a,c,d),a};function Z(a,b,c="validate"){if(w(a)||Array.isArray(a)&&a.every(w)||"boolean"==typeof a&&!a)return{type:c,message:w(a)?a:"",ref:b}}var $=a=>!j(a)||a instanceof RegExp?{value:a,message:""}:a,_=async(a,b,c,d,e,f)=>{let{ref:g,refs:h,required:k,maxLength:l,minLength:m,min:o,max:p,pattern:r,validate:s,name:t,valueAsNumber:v,mount:x}=a._f,y=q(c,t);if(!x||b.has(t))return{};let A=h?h[0]:g,B=a=>{e&&A.reportValidity&&(A.setCustomValidity("boolean"==typeof a?"":a||""),A.reportValidity())},F={},G="radio"===g.type,H="checkbox"===g.type,I=(v||"file"===g.type)&&n(g.value)&&n(y)||E(g)&&""===g.value||""===y||Array.isArray(y)&&!y.length,J=z.bind(null,t,d,F),K=(a,b,c,d=u.maxLength,e=u.minLength)=>{let f=a?b:c;F[t]={type:a?d:e,message:f,ref:g,...J(a?d:e,f)}};if(f?!Array.isArray(y)||!y.length:k&&(!(G||H)&&(I||i(y))||"boolean"==typeof y&&!y||H&&!M(h).isValid||G&&!P(h).isValid)){let{value:a,message:b}=w(k)?{value:!!k,message:k}:$(k);if(a&&(F[t]={type:u.required,message:b,ref:A,...J(u.required,b)},!d))return B(b),F}if(!I&&(!i(o)||!i(p))){let a,b,c=$(p),e=$(o);if(i(y)||isNaN(y)){let d=g.valueAsDate||new Date(y),f=a=>new Date(new Date().toDateString()+" "+a),h="time"==g.type,i="week"==g.type;w(c.value)&&y&&(a=h?f(y)>f(c.value):i?y>c.value:d>new Date(c.value)),w(e.value)&&y&&(b=h?f(y)<f(e.value):i?y<e.value:d<new Date(e.value))}else{let d=g.valueAsNumber||(y?+y:y);i(c.value)||(a=d>c.value),i(e.value)||(b=d<e.value)}if((a||b)&&(K(!!a,c.message,e.message,u.max,u.min),!d))return B(F[t].message),F}if((l||m)&&!I&&(w(y)||f&&Array.isArray(y))){let a=$(l),b=$(m),c=!i(a.value)&&y.length>+a.value,e=!i(b.value)&&y.length<+b.value;if((c||e)&&(K(c,a.message,b.message),!d))return B(F[t].message),F}if(r&&!I&&w(y)){let{value:a,message:b}=$(r);if(a instanceof RegExp&&!y.match(a)&&(F[t]={type:u.pattern,message:b,ref:g,...J(u.pattern,b)},!d))return B(b),F}if(s){if(D(s)){let a=Z(await s(y,c),A);if(a&&(F[t]={...a,...J(u.validate,a.message)},!d))return B(a.message),F}else if(j(s)){let a={};for(let b in s){if(!C(a)&&!d)break;let e=Z(await s[b](y,c),A,b);e&&(a={...e,...J(b,e.message)},B(e.message),d&&(F[t]=a))}if(!C(a)&&(F[t]={ref:A,...a},!d))return F}}return B(!0),F};let aa={mode:t.onSubmit,reValidateMode:t.onChange,shouldFocusError:!0};var ab=c(7033);let ac={success:a=>{alert(`✅ ${a}`)},error:a=>{alert(`❌ ${a}`)}},ad=ab.Ikc({title:ab.YjP().min(1,"Title is required").max(200,"Title too long"),artist:ab.YjP().min(1,"Artist is required").max(200,"Artist name too long"),bpm:ab.aig().int().positive("BPM must be positive").optional().or(ab.euz("")),keySig:ab.YjP().max(10,"Key signature too long").optional().or(ab.euz("")),priceAmount:ab.aig().positive("Price must be positive"),priceCurrency:ab.YjP().length(3,"Currency must be 3 characters"),status:ab.k5n(["draft","published","archived","processing","ready","error"])});function ae({assetId:a}){(0,f.useRouter)();let{data:b,isLoading:c,error:m}=(0,e.Qx)(a),[p,u]=(0,g.useState)(!1),{register:x,handleSubmit:z,formState:{errors:H,isDirty:I},reset:K,watch:L}=function(a={}){let b=g.useRef(void 0),c=g.useRef(void 0),[d,e]=g.useState({isDirty:!1,isValidating:!1,isLoading:D(a.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:a.errors||{},disabled:a.disabled||!1,isReady:!1,defaultValues:D(a.defaultValues)?void 0:a.defaultValues});if(!b.current)if(a.formControl)b.current={...a.formControl,formState:d},a.defaultValues&&!D(a.defaultValues)&&a.formControl.reset(a.defaultValues,a.resetOptions);else{let{formControl:c,...e}=function(a={}){let b,c={...aa,...a},d={submitCount:0,isDirty:!1,isReady:!1,isLoading:D(c.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:c.errors||{},disabled:c.disabled||!1},e={},f=(j(c.defaultValues)||j(c.values))&&l(c.defaultValues||c.values)||{},g=c.shouldUnregister?{}:l(f),m={action:!1,mount:!1,watch:!1},p={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u=0,v={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},x={...v},z={array:B(),state:B()},H=c.criteriaMode===t.all,I=async a=>{if(!c.disabled&&(v.isValid||x.isValid||a)){let a=c.resolver?C((await O()).errors):await T(e,!0);a!==d.isValid&&z.state.next({isValid:a})}},K=(a,b)=>{!c.disabled&&(v.isValidating||v.validatingFields||x.isValidating||x.validatingFields)&&((a||Array.from(p.mount)).forEach(a=>{a&&(b?r(d.validatingFields,a,b):G(d.validatingFields,a))}),z.state.next({validatingFields:d.validatingFields,isValidating:!C(d.validatingFields)}))},L=(a,b,c,d)=>{let h=q(e,a);if(h){let e=q(g,a,n(c)?q(f,a):c);n(e)||d&&d.defaultChecked||b?r(g,a,b?e:Q(h._f)):ab(a,e),m.mount&&I()}},M=(a,b,e,g,h)=>{let i=!1,j=!1,k={name:a};if(!c.disabled){if(!e||g){(v.isDirty||x.isDirty)&&(j=d.isDirty,d.isDirty=k.isDirty=Z(),i=j!==k.isDirty);let c=y(q(f,a),b);j=!!q(d.dirtyFields,a),c?G(d.dirtyFields,a):r(d.dirtyFields,a,!0),k.dirtyFields=d.dirtyFields,i=i||(v.dirtyFields||x.dirtyFields)&&!c!==j}if(e){let b=q(d.touchedFields,a);b||(r(d.touchedFields,a,e),k.touchedFields=d.touchedFields,i=i||(v.touchedFields||x.touchedFields)&&b!==e)}i&&h&&z.state.next(k)}return i?k:{}},O=async a=>{K(a,!0);let b=await c.resolver(g,c.context,((a,b,c,d)=>{let e={};for(let c of a){let a=q(b,c);a&&r(e,c,a._f)}return{criteriaMode:c,names:[...a],fields:e,shouldUseNativeValidation:d}})(a||p.mount,e,c.criteriaMode,c.shouldUseNativeValidation));return K(a),b},P=async a=>{let{errors:b}=await O(a);if(a)for(let c of a){let a=q(b,c);a?r(d.errors,c,a):G(d.errors,c)}else d.errors=b;return b},T=async(a,b,e={valid:!0})=>{for(let f in a){let h=a[f];if(h){let{_f:a,...f}=h;if(a){let f=p.array.has(a.name),i=h._f&&U(h._f);i&&v.validatingFields&&K([a.name],!0);let j=await _(h,p.disabled,g,H,c.shouldUseNativeValidation&&!b,f);if(i&&v.validatingFields&&K([a.name]),j[a.name]&&(e.valid=!1,b))break;b||(q(j,a.name)?f?Y(d.errors,j,a.name):r(d.errors,a.name,j[a.name]):G(d.errors,a.name))}C(f)||await T(f,b,e)}}return e.valid},Z=(a,b)=>!c.disabled&&(a&&b&&r(g,a,b),!y(ah(),f)),$=(a,b,c)=>{var d,e;return d=p,e={...m.mount?g:n(b)?f:w(a)?{[a]:b}:b},w(a)?(c&&d.watch.add(a),q(e,a,b)):Array.isArray(a)?a.map(a=>(c&&d.watch.add(a),q(e,a))):(c&&(d.watchAll=!0),e)},ab=(a,b,c={})=>{let d=q(e,a),f=b;if(d){let c=d._f;c&&(c.disabled||r(g,a,N(b,c)),f=E(c.ref)&&i(b)?"":b,"select-multiple"===c.ref.type?[...c.ref.options].forEach(a=>a.selected=f.includes(a.value)):c.refs?"checkbox"===c.ref.type?c.refs.forEach(a=>{a.defaultChecked&&a.disabled||(Array.isArray(f)?a.checked=!!f.find(b=>b===a.value):a.checked=f===a.value||!!f)}):c.refs.forEach(a=>a.checked=a.value===f):"file"===c.ref.type?c.ref.value="":(c.ref.value=f,c.ref.type||z.state.next({name:a,values:l(g)})))}(c.shouldDirty||c.shouldTouch)&&M(a,f,c.shouldTouch,c.shouldDirty,!0),c.shouldValidate&&ag(a)},ac=(a,b,c)=>{for(let d in b){if(!b.hasOwnProperty(d))return;let f=b[d],g=a+"."+d,i=q(e,g);(p.array.has(a)||j(f)||i&&!i._f)&&!h(f)?ac(g,f,c):ab(g,f,c)}},ad=(a,b,c={})=>{let h=q(e,a),j=p.array.has(a),k=l(b);r(g,a,k),j?(z.array.next({name:a,values:l(g)}),(v.isDirty||v.dirtyFields||x.isDirty||x.dirtyFields)&&c.shouldDirty&&z.state.next({name:a,dirtyFields:J(f,g),isDirty:Z(a,k)})):!h||h._f||i(k)?ab(a,k,c):ac(a,k,c),V(a,p)&&z.state.next({...d,name:a}),z.state.next({name:m.mount?a:void 0,values:l(g)})},ae=async a=>{m.mount=!0;let f=a.target,i=f.name,k=!0,n=q(e,i),o=a=>{k=Number.isNaN(a)||h(a)&&isNaN(a.getTime())||y(a,q(g,i,a))},t=S(c.mode),w=S(c.reValidateMode);if(n){let h,m,P,R,S=f.type?Q(n._f):j(R=a)&&R.target?"checkbox"===R.target.type?R.target.checked:R.target.value:R,U=a.type===s.BLUR||a.type===s.FOCUS_OUT,W=!((P=n._f).mount&&(P.required||P.min||P.max||P.maxLength||P.minLength||P.pattern||P.validate))&&!c.resolver&&!q(d.errors,i)&&!n._f.deps||(A=U,B=q(d.touchedFields,i),D=d.isSubmitted,E=w,!(F=t).isOnAll&&(!D&&F.isOnTouch?!(B||A):(D?E.isOnBlur:F.isOnBlur)?!A:(D?!E.isOnChange:!F.isOnChange)||A)),Y=V(i,p,U);r(g,i,S),U?f&&f.readOnly||(n._f.onBlur&&n._f.onBlur(a),b&&b(0)):n._f.onChange&&n._f.onChange(a);let Z=M(i,S,U),$=!C(Z)||Y;if(U||z.state.next({name:i,type:a.type,values:l(g)}),W)return(v.isValid||x.isValid)&&("onBlur"===c.mode?U&&I():U||I()),$&&z.state.next({name:i,...Y?{}:Z});if(!U&&Y&&z.state.next({...d}),c.resolver){let{errors:a}=await O([i]);if(o(S),k){let b=X(d.errors,e,i),c=X(a,e,b.name||i);h=c.error,i=c.name,m=C(a)}}else K([i],!0),h=(await _(n,p.disabled,g,H,c.shouldUseNativeValidation))[i],K([i]),o(S),k&&(h?m=!1:(v.isValid||x.isValid)&&(m=await T(e,!0)));if(k){n._f.deps&&(!Array.isArray(n._f.deps)||n._f.deps.length>0)&&ag(n._f.deps);var A,B,D,E,F,J=i,L=m,N=h;let a=q(d.errors,J),e=(v.isValid||x.isValid)&&"boolean"==typeof L&&d.isValid!==L;if(c.delayError&&N){let a;a=()=>{r(d.errors,J,N),z.state.next({errors:d.errors})},(b=b=>{clearTimeout(u),u=setTimeout(a,b)})(c.delayError)}else clearTimeout(u),b=null,N?r(d.errors,J,N):G(d.errors,J);if((N?!y(a,N):a)||!C(Z)||e){let a={...Z,...e&&"boolean"==typeof L?{isValid:L}:{},errors:d.errors,name:J};d={...d,...a},z.state.next(a)}}}},af=(a,b)=>{if(q(d.errors,b)&&a.focus)return a.focus(),1},ag=async(a,b={})=>{let f,g,h=A(a);if(c.resolver){let b=await P(n(a)?a:h);f=C(b),g=a?!h.some(a=>q(b,a)):f}else a?((g=(await Promise.all(h.map(async a=>{let b=q(e,a);return await T(b&&b._f?{[a]:b}:b)}))).every(Boolean))||d.isValid)&&I():g=f=await T(e);return z.state.next({...!w(a)||(v.isValid||x.isValid)&&f!==d.isValid?{}:{name:a},...c.resolver||!a?{isValid:f}:{},errors:d.errors}),b.shouldFocus&&!g&&W(e,af,a?h:p.mount),g},ah=(a,b)=>{let c={...m.mount?g:f};return b&&(c=function a(b,c){let d={};for(let e in b)if(b.hasOwnProperty(e)){let f=b[e],g=c[e];if(f&&j(f)&&g){let b=a(f,g);j(b)&&(d[e]=b)}else b[e]&&(d[e]=g)}return d}(b.dirtyFields?d.dirtyFields:d.touchedFields,c)),n(a)?c:w(a)?q(c,a):a.map(a=>q(c,a))},ai=(a,b)=>({invalid:!!q((b||d).errors,a),isDirty:!!q((b||d).dirtyFields,a),error:q((b||d).errors,a),isValidating:!!q(d.validatingFields,a),isTouched:!!q((b||d).touchedFields,a)}),aj=(a,b,c)=>{let f=(q(e,a,{_f:{}})._f||{}).ref,{ref:g,message:h,type:i,...j}=q(d.errors,a)||{};r(d.errors,a,{...j,...b,ref:f}),z.state.next({name:a,errors:d.errors,isValid:!1}),c&&c.shouldFocus&&f&&f.focus&&f.focus()},ak=a=>z.state.subscribe({next:b=>{let c,e,h;c=a.name,e=b.name,h=a.exact,(!c||!e||c===e||A(c).some(a=>a&&(h?a===e:a.startsWith(e)||e.startsWith(a))))&&((a,b,c,d)=>{c(a);let{name:e,...f}=a;return C(f)||Object.keys(f).length>=Object.keys(b).length||Object.keys(f).find(a=>b[a]===(!d||t.all))})(b,a.formState||v,as,a.reRenderRoot)&&a.callback({values:{...g},...d,...b,defaultValues:f})}}).unsubscribe,al=(a,b={})=>{for(let h of a?A(a):p.mount)p.mount.delete(h),p.array.delete(h),b.keepValue||(G(e,h),G(g,h)),b.keepError||G(d.errors,h),b.keepDirty||G(d.dirtyFields,h),b.keepTouched||G(d.touchedFields,h),b.keepIsValidating||G(d.validatingFields,h),c.shouldUnregister||b.keepDefaultValue||G(f,h);z.state.next({values:l(g)}),z.state.next({...d,...!b.keepDirty?{}:{isDirty:Z()}}),b.keepIsValid||I()},am=({disabled:a,name:b})=>{("boolean"==typeof a&&m.mount||a||p.disabled.has(b))&&(a?p.disabled.add(b):p.disabled.delete(b))},an=(a,b={})=>{let d=q(e,a),g="boolean"==typeof b.disabled||"boolean"==typeof c.disabled;return(r(e,a,{...d||{},_f:{...d&&d._f?d._f:{ref:{name:a}},name:a,mount:!0,...b}}),p.mount.add(a),d)?am({disabled:"boolean"==typeof b.disabled?b.disabled:c.disabled,name:a}):L(a,!0,b.value),{...g?{disabled:b.disabled||c.disabled}:{},...c.progressive?{required:!!b.required,min:R(b.min),max:R(b.max),minLength:R(b.minLength),maxLength:R(b.maxLength),pattern:R(b.pattern)}:{},name:a,onChange:ae,onBlur:ae,ref:g=>{if(g){let c;an(a,b),d=q(e,a);let h=n(g.value)&&g.querySelectorAll&&g.querySelectorAll("input,select,textarea")[0]||g,i="radio"===(c=h).type||"checkbox"===c.type,j=d._f.refs||[];(i?j.find(a=>a===h):h===d._f.ref)||(r(e,a,{_f:{...d._f,...i?{refs:[...j.filter(F),h,...Array.isArray(q(f,a))?[{}]:[]],ref:{type:h.type,name:a}}:{ref:h}}}),L(a,!1,void 0,h))}else{let f;(d=q(e,a,{}))._f&&(d._f.mount=!1),(c.shouldUnregister||b.shouldUnregister)&&(f=p.array,!f.has(a.substring(0,a.search(/\.\d+(\.|$)/))||a)||!m.action)&&p.unMount.add(a)}}}},ao=()=>c.shouldFocusError&&W(e,af,p.mount),ap=(a,b)=>async f=>{let h;f&&(f.preventDefault&&f.preventDefault(),f.persist&&f.persist());let i=l(g);if(z.state.next({isSubmitting:!0}),c.resolver){let{errors:a,values:b}=await O();d.errors=a,i=l(b)}else await T(e);if(p.disabled.size)for(let a of p.disabled)G(i,a);if(G(d.errors,"root"),C(d.errors)){z.state.next({errors:{}});try{await a(i,f)}catch(a){h=a}}else b&&await b({...d.errors},f),ao(),setTimeout(ao);if(z.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:C(d.errors)&&!h,submitCount:d.submitCount+1,errors:d.errors}),h)throw h},aq=(a,b={})=>{let h=a?l(a):f,i=l(h),j=C(a),o=j?f:i;if(b.keepDefaultValues||(f=h),!b.keepValues){if(b.keepDirtyValues)for(let a of Array.from(new Set([...p.mount,...Object.keys(J(f,g))])))q(d.dirtyFields,a)?r(o,a,q(g,a)):ad(a,q(o,a));else{if(k&&n(a))for(let a of p.mount){let b=q(e,a);if(b&&b._f){let a=Array.isArray(b._f.refs)?b._f.refs[0]:b._f.ref;if(E(a)){let b=a.closest("form");if(b){b.reset();break}}}}if(b.keepFieldsRef)for(let a of p.mount)ad(a,q(o,a));else e={}}g=c.shouldUnregister?b.keepDefaultValues?l(f):{}:l(o),z.array.next({values:{...o}}),z.state.next({values:{...o}})}p={mount:b.keepDirtyValues?p.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},m.mount=!v.isValid||!!b.keepIsValid||!!b.keepDirtyValues,m.watch=!!c.shouldUnregister,z.state.next({submitCount:b.keepSubmitCount?d.submitCount:0,isDirty:!j&&(b.keepDirty?d.isDirty:!!(b.keepDefaultValues&&!y(a,f))),isSubmitted:!!b.keepIsSubmitted&&d.isSubmitted,dirtyFields:j?{}:b.keepDirtyValues?b.keepDefaultValues&&g?J(f,g):d.dirtyFields:b.keepDefaultValues&&a?J(f,a):b.keepDirty?d.dirtyFields:{},touchedFields:b.keepTouched?d.touchedFields:{},errors:b.keepErrors?d.errors:{},isSubmitSuccessful:!!b.keepIsSubmitSuccessful&&d.isSubmitSuccessful,isSubmitting:!1,defaultValues:f})},ar=(a,b)=>aq(D(a)?a(g):a,b),as=a=>{d={...d,...a}},at={control:{register:an,unregister:al,getFieldState:ai,handleSubmit:ap,setError:aj,_subscribe:ak,_runSchema:O,_focusError:ao,_getWatch:$,_getDirty:Z,_setValid:I,_setFieldArray:(a,b=[],h,i,j=!0,k=!0)=>{if(i&&h&&!c.disabled){if(m.action=!0,k&&Array.isArray(q(e,a))){let b=h(q(e,a),i.argA,i.argB);j&&r(e,a,b)}if(k&&Array.isArray(q(d.errors,a))){let b,c=h(q(d.errors,a),i.argA,i.argB);j&&r(d.errors,a,c),o(q(b=d.errors,a)).length||G(b,a)}if((v.touchedFields||x.touchedFields)&&k&&Array.isArray(q(d.touchedFields,a))){let b=h(q(d.touchedFields,a),i.argA,i.argB);j&&r(d.touchedFields,a,b)}(v.dirtyFields||x.dirtyFields)&&(d.dirtyFields=J(f,g)),z.state.next({name:a,isDirty:Z(a,b),dirtyFields:d.dirtyFields,errors:d.errors,isValid:d.isValid})}else r(g,a,b)},_setDisabledField:am,_setErrors:a=>{d.errors=a,z.state.next({errors:d.errors,isValid:!1})},_getFieldArray:a=>o(q(m.mount?g:f,a,c.shouldUnregister?q(f,a,[]):[])),_reset:aq,_resetDefaultValues:()=>D(c.defaultValues)&&c.defaultValues().then(a=>{ar(a,c.resetOptions),z.state.next({isLoading:!1})}),_removeUnmounted:()=>{for(let a of p.unMount){let b=q(e,a);b&&(b._f.refs?b._f.refs.every(a=>!F(a)):!F(b._f.ref))&&al(a)}p.unMount=new Set},_disableForm:a=>{"boolean"==typeof a&&(z.state.next({disabled:a}),W(e,(b,c)=>{let d=q(e,c);d&&(b.disabled=d._f.disabled||a,Array.isArray(d._f.refs)&&d._f.refs.forEach(b=>{b.disabled=d._f.disabled||a}))},0,!1))},_subjects:z,_proxyFormState:v,get _fields(){return e},get _formValues(){return g},get _state(){return m},set _state(value){m=value},get _defaultValues(){return f},get _names(){return p},set _names(value){p=value},get _formState(){return d},get _options(){return c},set _options(value){c={...c,...value}}},subscribe:a=>(m.mount=!0,x={...x,...a.formState},ak({...a,formState:x})),trigger:ag,register:an,handleSubmit:ap,watch:(a,b)=>D(a)?z.state.subscribe({next:c=>"values"in c&&a($(void 0,b),c)}):$(a,b,!0),setValue:ad,getValues:ah,reset:ar,resetField:(a,b={})=>{q(e,a)&&(n(b.defaultValue)?ad(a,l(q(f,a))):(ad(a,b.defaultValue),r(f,a,l(b.defaultValue))),b.keepTouched||G(d.touchedFields,a),b.keepDirty||(G(d.dirtyFields,a),d.isDirty=b.defaultValue?Z(a,l(q(f,a))):Z()),!b.keepError&&(G(d.errors,a),v.isValid&&I()),z.state.next({...d}))},clearErrors:a=>{a&&A(a).forEach(a=>G(d.errors,a)),z.state.next({errors:a?d.errors:{}})},unregister:al,setError:aj,setFocus:(a,b={})=>{let c=q(e,a),d=c&&c._f;if(d){let a=d.refs?d.refs[0]:d.ref;a.focus&&(a.focus(),b.shouldSelect&&D(a.select)&&a.select())}},getFieldState:ai};return{...at,formControl:at}}(a);b.current={...e,formState:d}}let f=b.current.control;return f._options=a,v(()=>{let a=f._subscribe({formState:f._proxyFormState,callback:()=>e({...f._formState}),reRenderRoot:!0});return e(a=>({...a,isReady:!0})),f._formState.isReady=!0,a},[f]),g.useEffect(()=>f._disableForm(a.disabled),[f,a.disabled]),g.useEffect(()=>{a.mode&&(f._options.mode=a.mode),a.reValidateMode&&(f._options.reValidateMode=a.reValidateMode)},[f,a.mode,a.reValidateMode]),g.useEffect(()=>{a.errors&&(f._setErrors(a.errors),f._focusError())},[f,a.errors]),g.useEffect(()=>{a.shouldUnregister&&f._subjects.state.next({values:f._getWatch()})},[f,a.shouldUnregister]),g.useEffect(()=>{if(f._proxyFormState.isDirty){let a=f._getDirty();a!==d.isDirty&&f._subjects.state.next({isDirty:a})}},[f,d.isDirty]),g.useEffect(()=>{a.values&&!y(a.values,c.current)?(f._reset(a.values,{keepFieldsRef:!0,...f._options.resetOptions}),c.current=a.values,e(a=>({...a}))):f._resetDefaultValues()},[f,a.values]),g.useEffect(()=>{f._state.mount||(f._setValid(),f._state.mount=!0),f._state.watch&&(f._state.watch=!1,f._subjects.state.next({...f._formState})),f._removeUnmounted()}),b.current.formState=((a,b,c,d=!0)=>{let e={defaultValues:b._defaultValues};for(let c in a)Object.defineProperty(e,c,{get:()=>(b._proxyFormState[c]!==t.all&&(b._proxyFormState[c]=!d||t.all),a[c])});return e})(d,f),b.current}({resolver:async a=>{let b=ad.safeParse(a);if(b.success)return{values:b.data,errors:{}};let c=b.error.flatten(),d={};for(let[a,b]of Object.entries(c.fieldErrors))Array.isArray(b)&&b.length>0&&(d[a]={type:"validation",message:b[0]});return Array.isArray(c.formErrors)&&c.formErrors.length>0&&(d._root={type:"validation",message:c.formErrors[0]}),{values:{},errors:d}},defaultValues:{title:"",artist:"",bpm:void 0,keySig:"",priceAmount:0,priceCurrency:"USD",status:"ready"}}),M=(0,e.zC)({onSuccess:a=>{ac.success("Asset updated successfully"),u(!1)},onError:a=>{ac.error(`Update failed: ${a.message}`)}}),O=b=>{let c={title:b.title,artist:b.artist,priceAmount:b.priceAmount,priceCurrency:b.priceCurrency,status:b.status,...void 0!==b.bpm&&""!==b.bpm?{bpm:b.bpm}:{},...b.keySig&&""!==b.keySig?{keySig:b.keySig}:{}},d=`edit-${a}-${Date.now()}`;M.mutate({id:a,updates:c,idempotencyKey:d})};return c?(0,d.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,d.jsx)("div",{className:"text-fg/70",children:"Loading asset..."})}):m?(0,d.jsx)("div",{className:"rounded-md border border-red-500/20 bg-red-500/10 p-4",children:(0,d.jsxs)("div",{className:"text-red-400",children:["Error loading asset: ",m.message]})}):b?(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h2",{className:"text-lg font-semibold",children:"Asset Details"}),(0,d.jsx)("div",{className:"flex gap-2",children:p?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{type:"button",onClick:()=>{b&&K({title:b.title,artist:b.artist,bpm:b.bpm??void 0,keySig:b.keySig??"",priceAmount:b.priceAmount,priceCurrency:b.priceCurrency,status:b.status}),u(!1)},className:"rounded-md border border-fg/20 bg-transparent px-3 py-2 text-sm font-medium text-fg hover:bg-fg/5",disabled:M.isPending,children:"Cancel"}),(0,d.jsx)("button",{type:"button",onClick:z(O),disabled:!I||M.isPending,className:"rounded-md bg-brand-600 px-3 py-2 text-sm font-medium text-white hover:bg-brand-700 disabled:opacity-50",children:M.isPending?"Saving...":"Save Changes"})]}):(0,d.jsx)("button",{type:"button",onClick:()=>u(!0),className:"rounded-md bg-brand-600 px-3 py-2 text-sm font-medium text-white hover:bg-brand-700",children:"Edit"})})]}),(0,d.jsxs)("form",{onSubmit:z(O),className:"space-y-4",children:[(0,d.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-fg",children:"Title *"}),(0,d.jsx)("input",{...x("title"),type:"text",id:"title",disabled:!p,className:"mt-1 block w-full rounded-md border border-fg/20 bg-bg px-3 py-2 text-fg placeholder-fg/50 focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 disabled:bg-fg/5 disabled:text-fg/70",placeholder:"Enter asset title"}),H.title&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-400",children:H.title.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"artist",className:"block text-sm font-medium text-fg",children:"Artist *"}),(0,d.jsx)("input",{...x("artist"),type:"text",id:"artist",disabled:!p,className:"mt-1 block w-full rounded-md border border-fg/20 bg-bg px-3 py-2 text-fg placeholder-fg/50 focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 disabled:bg-fg/5 disabled:text-fg/70",placeholder:"Enter artist name"}),H.artist&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-400",children:H.artist.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"bpm",className:"block text-sm font-medium text-fg",children:"BPM"}),(0,d.jsx)("input",{...x("bpm",{valueAsNumber:!0}),type:"number",id:"bpm",disabled:!p,className:"mt-1 block w-full rounded-md border border-fg/20 bg-bg px-3 py-2 text-fg placeholder-fg/50 focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 disabled:bg-fg/5 disabled:text-fg/70",placeholder:"120"}),H.bpm&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-400",children:H.bpm.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"keySig",className:"block text-sm font-medium text-fg",children:"Key Signature"}),(0,d.jsx)("input",{...x("keySig"),type:"text",id:"keySig",disabled:!p,className:"mt-1 block w-full rounded-md border border-fg/20 bg-bg px-3 py-2 text-fg placeholder-fg/50 focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 disabled:bg-fg/5 disabled:text-fg/70",placeholder:"C Major"}),H.keySig&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-400",children:H.keySig.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"priceAmount",className:"block text-sm font-medium text-fg",children:"Price Amount *"}),(0,d.jsx)("input",{...x("priceAmount",{valueAsNumber:!0}),type:"number",step:"0.01",id:"priceAmount",disabled:!p,className:"mt-1 block w-full rounded-md border border-fg/20 bg-bg px-3 py-2 text-fg placeholder-fg/50 focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 disabled:bg-fg/5 disabled:text-fg/70",placeholder:"29.99"}),H.priceAmount&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-400",children:H.priceAmount.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"priceCurrency",className:"block text-sm font-medium text-fg",children:"Currency *"}),(0,d.jsxs)("select",{...x("priceCurrency"),id:"priceCurrency",disabled:!p,className:"mt-1 block w-full rounded-md border border-fg/20 bg-bg px-3 py-2 text-fg focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 disabled:bg-fg/5 disabled:text-fg/70",children:[(0,d.jsx)("option",{value:"USD",children:"USD"}),(0,d.jsx)("option",{value:"PYUSD",children:"PYUSD"}),(0,d.jsx)("option",{value:"ETH",children:"ETH"})]}),H.priceCurrency&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-400",children:H.priceCurrency.message})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-fg",children:"Status *"}),(0,d.jsxs)("select",{...x("status"),id:"status",disabled:!p,className:"mt-1 block w-full rounded-md border border-fg/20 bg-bg px-3 py-2 text-fg focus:border-brand-500 focus:outline-none focus:ring-1 focus:ring-brand-500 disabled:bg-fg/5 disabled:text-fg/70",children:[(0,d.jsx)("option",{value:"processing",children:"Processing"}),(0,d.jsx)("option",{value:"ready",children:"Ready"}),(0,d.jsx)("option",{value:"error",children:"Error"})]}),H.status&&(0,d.jsx)("p",{className:"mt-1 text-sm text-red-400",children:H.status.message})]})]}),M.isPending&&(0,d.jsx)("div",{className:"rounded-md border border-blue-500/20 bg-blue-500/10 p-3",children:(0,d.jsx)("div",{className:"text-blue-400",children:"Updating asset..."})}),M.error&&(0,d.jsx)("div",{className:"rounded-md border border-red-500/20 bg-red-500/10 p-3",children:(0,d.jsxs)("div",{className:"text-red-400",children:["Update failed: ",M.error.message]})})]})]}):(0,d.jsx)("div",{className:"rounded-md border border-red-500/20 bg-red-500/10 p-4",children:(0,d.jsx)("div",{className:"text-red-400",children:"Asset not found"})})}},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64939:a=>{"use strict";a.exports=import("pg")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},89981:(a,b,c)=>{"use strict";c.d(b,{Qx:()=>p,dU:()=>o,I0:()=>r,zC:()=>q});var d=c(27380),e=c(32315),f=c(50292),g=c(7033);let h=g.Ikc({id:g.YjP(),title:g.YjP(),artist:g.YjP(),bpm:g.aig().nullable(),keySig:g.YjP().nullable(),priceAmount:g.aig(),priceCurrency:g.YjP(),status:g.k5n(["draft","published","archived","processing","ready","error"]),updatedAt:g.aig(),createdAt:g.aig()}),i=g.Ikc({items:g.YOg(h),nextCursor:g.YjP().nullable()}),j=process.env.NEXT_PUBLIC_API_URL??"http://localhost:3000";async function k(a={}){let b=new URLSearchParams;a.limit&&b.set("limit",a.limit.toString()),a.cursor&&b.set("cursor",a.cursor),a.status&&b.set("status",a.status),a.q&&b.set("q",a.q);let c=`${j}/api/assets?${b.toString()}`,d=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json"}});if(!d.ok)throw Error(`Failed to fetch assets: ${d.statusText}`);let e=await d.json();return i.parse(e)}async function l(a){let b=`${j}/api/assets/${a}`,c=await fetch(b,{method:"GET",headers:{"Content-Type":"application/json"}});if(!c.ok){if(404===c.status)throw Error(`Asset not found: ${a}`);throw Error(`Failed to fetch asset: ${c.statusText}`)}let d=await c.json();return h.parse(d)}async function m(a,b,c){let d=`${j}/api/assets/${a}`,e=await fetch(d,{method:"PATCH",headers:{"Content-Type":"application/json","Idempotency-Key":c},body:JSON.stringify(b)});if(!e.ok){if(404===e.status)throw Error(`Asset not found: ${a}`);if(422===e.status){let a=await e.json();throw Error(`Validation failed: ${JSON.stringify(a.details||a.error)}`)}throw Error(`Failed to update asset: ${e.statusText}`)}let f=await e.json();return h.parse(f)}async function n(a,b="ready",c){let d=`${j}/api/upload/complete`,e=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assetId:a,status:b,errorMessage:c})});if(!e.ok){if(404===e.status)throw Error(`Asset not found: ${a}`);throw Error(`Failed to complete asset processing: ${e.statusText}`)}return e.json()}function o(a={},b){return(0,d.useQuery)({queryKey:["assets",a],queryFn:()=>k(a),...b})}function p(a,b){return(0,d.useQuery)({queryKey:["asset",a],queryFn:()=>l(a),enabled:!!a,...b})}function q(a){let b=(0,e.useQueryClient)();return(0,f.useMutation)({mutationFn:({id:a,updates:b,idempotencyKey:c})=>m(a,b,c),onSuccess:(a,c)=>{b.invalidateQueries({queryKey:["asset",c.id]}),b.invalidateQueries({queryKey:["assets"]})},...a})}function r(a){let b=(0,e.useQueryClient)();return(0,f.useMutation)({mutationFn:({assetId:a,status:b,errorMessage:c})=>n(a,b,c),onSuccess:(a,c)=>{b.invalidateQueries({queryKey:["asset",c.assetId]}),b.invalidateQueries({queryKey:["assets"]})},...a})}},99953:(a,b,c)=>{Promise.resolve().then(c.bind(c,16529)),Promise.resolve().then(c.bind(c,45345)),Promise.resolve().then(c.bind(c,28999))}};var b=require("../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[635,612,770,835,325,787,268,827],()=>b(b.s=29720));module.exports=c})();